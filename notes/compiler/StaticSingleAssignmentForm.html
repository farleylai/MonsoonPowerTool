<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Static Single-Assignment Form</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">
    <meta name="generator" content="JBake">

    <!-- Le styles -->
    <link href="../../css/bootstrap.min.css" rel="stylesheet">
    <link href="../../css/asciidoctor.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link href="../../css/prettify.css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="../../favicon.ico">
  </head>
  <body onload="prettyPrint()">
    <div id="wrap">
   


		<!-- Fixed navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../notes/about.html">Farley Lai</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../../index.html">Blog</a></li>
            <li><a href="../../notes/projects.html">Projects</a></li>
            <li><a href="../../notes/research.html">Research</a></li>
            <li><a href="../../notes/events.html">Events</a></li>
            <li><a href="../../notes/art.html">Art</a></li>
            <li><a href="../../archive.html">Archive</a></li>
            <li><a href="../../feed.xml">Feed</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Shortcut <b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="../../notes/linux.html">Linux</a></li>
                <li><a href="../../notes/groovy.html">Groovy</a></li>
                <li><a href="../../notes/tools.html">Tools</a></li>
                <li><a href="../../notes/resources.html">Resources</a></li>
                <li class="divider"></li>
                <li class="dropdown-header">Compiler</li>
                <li><a href="../../notes/compiler/DataFlowAnalysis.html">Data-Flow Analsyis</a></li>
                <li><a href="../../notes/compiler/StaticSingleAssignmentForm.html">Static Single Assignement Form</a></li>
                <li><a href="../../notes/compiler/CompilerOptimizations.html">Compiler Optimizations</a></li>
              </ul>
            </li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://github.com/farleylai"><i class="fa fa-github"></i></a></li>
            <li><a href="https://plus.google.com/+FarleyLai/"><i class="fa fa-google-plus"></i></a>
            <li><a href="https://www.linkedin.com/in/farleylai"><i class="fa fa-linkedin"></i></a>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
    <div class="container">

	
	<div class="page-header">
		<h1>Static Single-Assignment Form</h1>
	</div>

	<p><em>14 October 2015</em></p>

	<p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>SSA serves as one universal analysis for multiple transformations.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_maximal_ssa_form">Maximal SSA Form</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Inserting \(\phi-functions\) at joints</p>
</li>
<li>
<p>Renaming such that only one definition reaches any use</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>However, too many extra \(phi\)-functions waste space and slow down the traversal.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_semipruned_ssa_form">Semipruned SSA Form</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_dominance_frontier">Dominance Frontier</h3>
<div class="paragraph">
<p>For each block <em>i</em>, compute the set of blocks that will need a \(phi\)-function for any definition in block <em>i</em>.
Block \(n \in DOM(m)\) does not force the presence of a \(\phi\)-function if there is a redefinition in some node <em>p</em> between <em>n</em> and
<em>m</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Strict Dominance</dt>
<dd>
<p><em>a</em> strictly dominates <em>b</em> iff \(a \in DOM(b) - \{ b \}\)</p>
</dd>
<dt class="hdlist1">Dominance Frontier</dt>
<dd>
<p>\(DF(n)\) is the set of join block <em>m</em> such tha</p>
<div class="ulist">
<ul>
<li>
<p>\(n \in DOM(q) | q \in preds(m)\)</p>
</li>
<li>
<p><em>n</em> does not strictly dominate <em>m</em></p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">Immediate Dominator</dt>
<dd>
<p>\(IDOM(n)\) is the closest dominator that strictly dominates <em>n</em>.</p>
</dd>
<dt class="hdlist1">Dominator Tree</dt>
<dd>
<p>If m is \(IDOM(n)\), then the dominator tree has an edge from <em>m</em> to <em>n</em>.</p>
</dd>
</dl>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_renaming">Renaming</h3>
<div class="paragraph">
<p>A definition in block <em>n</em> forces a corresponding \(phi\)-function at any join point \(m \in DF(n)\).
Only insert \(phi\)-functions for global names that are live across multiple blocks.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Global Names \(= \bigcup_b UEVar(b)\)</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Build global names and their definition block lists</p>
</li>
<li>
<p>For each name <em>x</em>, iteratively insert \(phi\)-function into the dominator frontier <em>b</em> of definition blocks of <em>x</em></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If \(x \in LiveOut(b) \), the SSA is pruned.</p>
</div>
</div>
<div class="sect2">
<h3 id="_translation_out_of_ssa_form">Translation Out of SSA Form</h3>
<div class="sect3">
<h4 id="_lost_copy_problem">Lost-Copy Problem</h4>
<div class="paragraph">
<p>Splitting critical edges is the way to implement \(phi\)-functions.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
<div class="dlist">
<dl>
<dt class="hdlist1">Critical Edge</dt>
<dd>
<p>An edge in a CFG whose source has multiple successors and whose sink has multiple predecessors may be split by the
compiler by inserting a block in between.
A critical edge is usually a back edge.</p>
</dd>
</dl>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Sometimes, the compiler avoids splitting critical edges:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The closing branch of a heavily executed loop may have an adverse performance impact</p>
</li>
<li>
<p>Adding blocks and edges in the late stages of compilation can interfere with</p>
<div class="ulist">
<ul>
<li>
<p>regional scheduling,</p>
</li>
<li>
<p>register allocation,</p>
</li>
<li>
<p>code placement and so on</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>However unsplit critical edges with copy folding causes the lost-copy problem.
The compiler preserves the live value in a temporary name and rewrite usbsequent uses to refer to the temporary name if
the liveness of the target name is outside the block for each copy inserted during the out-of-SSA translation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_swap_problem">Swap Problem</h4>
<div class="paragraph">
<p>The \(phi\)-functions are executed concurrently by reading parameters and defining the target values simultaneously.
However, the translation of SSA from into sequential executable code may misinterpret the semantics.
The swap problem can be detected when \(phi\)-functions reference the targets of other \(phi\)-functions in the same block.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_ssa_form">Using SSA Form</h3>

</div>
<div class="sect2">
<h3 id="_sparse_simple_constant_propagation_sscp">Sparse Simple Constant Propagation (SSCP)</h3>
<div class="paragraph">
<p>Each SSA name is annotated with a value ranging from \(\top, \bot\), or \(c_i\).
The set of possible values forms a semilattice.
SSCP determines if a SSA name is constant in a block.
First, SSCP initializes SSA names as follows.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>\(\top\) from a \(phi\)-function</p>
</li>
<li>
<p>\(c_i\) from some known constant</p>
</li>
<li>
<p>\(\bot\) from some external input</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Next, SSCP iterates by propagating SSA names defined to be some constant \(c_i\) and checking its uses.
The target SSA names may be defined from \(\top\) to constant \(c_i\) or from constant \(c_i\) to \(\bot\) but no more.
Interpreting a \(phi\)-function to to define a SSA name follows the rules below.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>\(\top \wedge x = x, \forall x\)</p>
</li>
<li>
<p>\(\bot \wedge x = \bot, \forall x\)</p>
</li>
<li>
<p>\(c_i \wedge c_j = c_i\) if \(c_i = c_j\)</p>
</li>
<li>
<p>\(c_i \wedge c_j = \bot\) if \(c_i \not= c_j\)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Those SSA names end up with some constant \(c_i\) are propogated.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_interprocedural_constant_propagation">Interprocedural Constant Propagation</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Discovering an Initial Set of Constants</p>
<div class="ulist">
<ul>
<li>
<p>Identify which actual parameters have known constant values</p>
</li>
<li>
<p>Literal constant values</p>
</li>
<li>
<p>Global constant propagation</p>
</li>
</ul>
</div>
</li>
<li>
<p>Propagation Known Constant Values around the Call Graph</p>
</li>
<li>
<p>Modeling Transmission of Values through Procedures</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_structural_data_flow_algorithms_and_reducibility">Structural Data-Flow Algorithms and Reducibility</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Reduce phase: each time a subgraph is transformed into a node</p>
<div class="ulist">
<ul>
<li>
<p>\(T_1(n)\): self-loop</p>
</li>
<li>
<p>\(T_2(a, b)\): <em>b</em> has only one predecessor <em>a</em></p>
</li>
</ul>
</div>
</li>
<li>
<p>Expansion phase: each time a node is expanded with computed data-flow sets</p>
</li>
<li>
<p>Irreducible graphs</p>
<div class="ulist">
<ul>
<li>
<p>Failed to be reduced to a single node with \(T_1\) and \(T_2\)</p>
</li>
<li>
<p>More than two iterations required by iterative DOM framework using an RPO traversal order</p>
</li>
<li>
<p>There exists a loop or cycle that has edges entering it at different nodes</p>
</li>
<li>
<p>Node splitting to form cycles with one single entry</p>
</li>
<li>
<p>Structured programming without goto or break prevents irreducible graphs</p>
</li>
<li>
<p>Mutually recursive subroutines in recursive-descent parser is likely to have irreducible subgraphs</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_speed_up_the_iterative_dom_framework">Speed up the Iterative DOM Framework</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Build the dominator tree and find the DOM on demand</p>
</li>
<li>
<p>Traverse CFG upward by comparing RPO numbers until reaching a common prefix node as IDOM</p>
</li>
</ul>
</div>
</div>
</div></p>

	<hr />

		</div>
		<div id="push"></div>
    </div>
    
    <div id="footer">
<!--
      <div class="container">
        <p class="muted credit">&copy; 2014 | Mixed with <a href="http://getbootstrap.com/">Bootstrap v3.1.1</a>
         | Baked with <a href="http://jbake.org">JBake v2.3.0</a></p>
      </div>
-->
      <div class="container">
        <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.en_US">
        <img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-nd/3.0/88x31.png" /></a>
        This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.en_US">
        Creative Commons Attribution-NonCommercial-NoDerivs 3.0 Unported License</a>.
      </div>
    </div>
    
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../../js/jquery-1.11.1.min.js"></script>
    <script src="../../js/bootstrap.min.js"></script>
    <script src="../../js/prettify.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-15840099-1', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>
